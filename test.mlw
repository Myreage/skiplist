module Skiplist

  use import int.Int
  use import array.Array
  type skiplist 'a = Empty | Succ 'a (skiplist 'a) (skiplist 'a)

  (*type skiplist 'a = {
    value: 'a;
    ne : list 'a;       (* next element *)    (* Element suivant dans la mÃªme couche *)
    nl : list 'a;      (* next layer *)    (* Couche inferieure *)
  }*)

  (*let root (v: 'a) : skiplist 'a = Succ (v; Empty; Empty)*)

  let rec mem_skiplist (v: 'a) (sl: skiplist 'a) : bool =
    match sl with
    | Empty -> False
    | Succ v_sl he hl -> if v = v_sl then True
                                     else match he with
                                          | Empty -> False
                                          | Succ v2_sl he2 hl2 -> if v2_sl <= v then mem_skiplist v he
                                                                                else mem_skiplist v hl
                                          end
    end

end